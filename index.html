<section id="result-section">
  <!-- Automatically load results.xlsx when the page loads -->
  <input type="hidden" id="file-input" value="results.xlsx" />
  <input type="text" id="search" placeholder="Search by name..." />
  <table id="result-table">
    <thead>
      <tr>
        <th>Rank</th>
        <th>Name</th>
        <th>GPA</th>
        <th>CGPA</th>
      </tr>
    </thead>
    <tbody>
      <!-- Rows will be dynamically added -->
    </tbody>
  </table>
</section>

<script>
  window.onload = function() {
    // Automatically trigger the file load when the page loads
    const fileInput = document.getElementById("file-input");
    const filePath = fileInput.value;

    // Manually load the file if it's a static file in the directory
    if (filePath === "results.xlsx") {
      const file = new File([""], "results.xlsx", { type: "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" });

      const reader = new FileReader();
      reader.onload = function(event) {
        const data = new Uint8Array(event.target.result);
        const workbook = XLSX.read(data, { type: "array" });
        const sheetName = workbook.SheetNames[0];
        const worksheet = workbook.Sheets[sheetName];
        const jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

        populateTable(jsonData);
      };

      reader.readAsArrayBuffer(file);
    }
  };
</script>
